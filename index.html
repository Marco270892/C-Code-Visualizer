<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C Code to PDF - Premium Highlighter</title>
    <meta name="description" content="Converti il tuo codice C in un PDF formattato con evidenziazione della sintassi.">
    <!-- Google Fonts (Moved from CSS for better performance & html2canvas support) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="style.css">
    <!-- Prism.js Tomorrow Night Theme (Online CDN) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <!-- MathJax for LaTeX support -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            }
        };
    </script>
    <!-- MathJax for LaTeX support (Online CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Flowchart.js for Flowcharts -->
    <!-- (Mermaid removed to avoid conflicts) -->
    <!-- Chart.js for graphs (Online CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Home Screen Selection -->
    <div id="home-screen" class="home-container">
        <header class="home-header">
            <h1>Select Your Task</h1>
            <p class="subtitle">Scegli il tipo di documento che vuoi creare oggi</p>
        </header>

        <div class="mode-selector">
            <div class="mode-card" id="mode-code">
                <div class="mode-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="16 18 22 12 16 6"></polyline>
                        <polyline points="8 6 2 12 8 18"></polyline>
                    </svg>
                </div>
                <h3>Software Developer</h3>
                <p>Formatta il tuo codice C con syntax highlighting professionale.</p>
                <button class="btn btn-primary">Inizia Codice</button>
            </div>

            <div class="mode-card" id="mode-lab">
                <div class="mode-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                </div>
                <h3>Lab Specialist</h3>
                <p>Crea relazioni tecniche di laboratorio complete e ordinate.</p>
                <button class="btn btn-primary">Inizia Laboratorio</button>
            </div>

            <div class="mode-card" id="mode-flowchart">
                <div class="mode-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                </div>
                <h3>Flowchart Designer</h3>
                <p>Disegna diagrammi di flusso usando la sintassi flowchart.js.</p>
                <button class="btn btn-primary">Inizia Flowchart</button>
            </div>
            <div class="mode-card" id="mode-plc">
                <div class="mode-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4z">
                        </path>
                    </svg>
                </div>
                <h3>PLC Integrator</h3>
                <p>Gestione progetti Siemens & Schneider (LAD/SCL).</p>
                <button class="btn btn-primary">Inizia PLC</button>
            </div>
        </div>
    </div>

    <!-- Main Application Screen -->
    <div id="app-screen" class="container hidden">
        <header>
            <div class="header-top">
                <button id="back-to-home" class="btn btn-secondary btn-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                    Torna Home
                </button>
                <h1 id="app-type-title">C Code Visualizer</h1>
                <button id="info-btn" class="btn btn-secondary btn-sm" style="position: absolute; right: 0;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    Info Guide
                </button>
            </div>
            <p id="app-type-subtitle" class="subtitle">Incolla il tuo codice C, visualizzalo con syntax highlighting e
                scaricalo in PDF.</p>
        </header>
        <main class="main-content">
            <div class="editor-side">
                <section class="customization-section">
                    <div class="section-header">
                        <span class="section-title">1. Informazioni Documento</span>
                        <div class="controls-mini">
                            <button id="download-btn-top" class="btn btn-primary btn-sm">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                Scarica PDF
                            </button>
                        </div>
                    </div>
                    <div class="customization-grid">
                        <div class="input-group">
                            <label for="project-title">Titolo del Progetto</label>
                            <input type="text" id="project-title" placeholder="Esempio: Socket in C"
                                value="Codice Sorgente C">
                        </div>
                        <div class="input-group">
                            <label>Logo</label>
                            <div class="file-input-wrapper">
                                <input type="file" id="logo-upload" accept="image/*" class="hidden">
                                <button type="button" class="btn btn-secondary btn-sm"
                                    onclick="document.getElementById('logo-upload').click()">
                                    Carica
                                </button>
                                <div id="logo-status" class="status-text">Mancante</div>
                            </div>
                        </div>
                        <div class="input-group">
                            <label for="school-name">Scuola / Istituto</label>
                            <input type="text" id="school-name" placeholder="Esempio: ITI G. Marconi">
                        </div>
                        <div class="input-group">
                            <label for="student-info">Studente / Classe</label>
                            <input type="text" id="student-info" placeholder="Esempio: Mario Rossi - 4A INF">
                        </div>
                        <div class="input-group">
                            <label for="doc-date">Data</label>
                            <input type="date" id="doc-date">
                        </div>
                    </div>
                    <div class="input-group exercise-group">
                        <label for="exercise-text">Traccia dell'Esercizio</label>
                        <textarea id="exercise-text" placeholder="Incolla qui la traccia..." rows="2"></textarea>
                    </div>


                    <div id="lab-details-fields" class="hidden">
                        <div class="customization-grid lab-grid" style="grid-template-columns: repeat(2, 1fr);">
                            <div class="input-group">
                                <label for="lab-objectives">Obiettivi</label>
                                <textarea id="lab-objectives" placeholder="Obiettivi dell'esercitazione..."
                                    rows="2"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="lab-materials">Materiali</label>
                                <textarea id="lab-materials" placeholder="Es:
— Componente 1
— Componente 2..." rows="4"></textarea>
                            </div>
                        </div>
                        <div class="customization-grid lab-grid"
                            style="grid-template-columns: repeat(2, 1fr); margin-top: 10px;">
                            <div class="input-group">
                                <label for="lab-tools">Strumenti / Hardware</label>
                                <textarea id="lab-tools" placeholder="Es:
— Strumento 1
— Strumento 2..." rows="4"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="lab-software">Software / App</label>
                                <textarea id="lab-software" placeholder="Es:
— Software 1
— App 2..." rows="4"></textarea>
                            </div>
                        </div>
                        <div class="input-group exercise-group">
                            <label for="lab-description">Descrizione Attività / Procedimento</label>
                            <textarea id="lab-description" placeholder="Descrivi i passaggi svolti..."
                                rows="8"></textarea>
                        </div>
                        <div class="input-group exercise-group">
                            <label for="lab-conclusions">Conclusioni / Risultati</label>
                            <textarea id="lab-conclusions" placeholder="Osservazioni finali..." rows="6"></textarea>
                        </div>

                        <div class="lab-calculations-section">
                            <span class="section-title-small">Analisi, Calcoli e Formule Libere</span>
                            <div class="input-group">
                                <label for="lab-calculations">Inserisci qui calcoli o formule (anche in LaTeX)</label>
                                <textarea id="lab-calculations"
                                    placeholder="Esempio: Calcolo della pendenza $m = \frac{\Delta y}{\Delta x}$..."
                                    rows="12"></textarea>
                            </div>
                        </div>

                        <div id="lab-charts-input-container">
                            <!-- Qui verranno aggiunti i blocchi dei grafici -->
                        </div>

                        <div class="add-chart-wrapper">
                            <button type="button" id="add-chart-btn" class="btn btn-secondary btn-sm"
                                style="margin-bottom: 20px;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                Aggiungi Nuova Tabella/Grafico
                            </button>
                        </div>

                        <!-- CIRCUIT EDITOR SECTION -->
                        <div class="circuit-section"
                            style="margin-top: 10px; border-top: 1px dashed rgba(255,255,255,0.1); padding-top: 20px;">
                            <span class="section-title-small">Schemi Elettrici (Beta)</span>

                            <div class="circuit-editor-container"
                                style="background: rgba(15, 23, 42, 0.5); padding: 15px; border-radius: 8px; border: 1px solid var(--border-color); margin-top: 10px;">

                                <!-- Toolbar -->
                                <div class="circuit-toolbar"
                                    style="display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap;">
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool active"
                                        data-tool="select" title="Seleziona/Sposta">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z" />
                                            <path d="M13 13l6 6" />
                                        </svg>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool" data-tool="wire"
                                        title="Filo">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M5 12h14" />
                                        </svg>
                                    </button>
                                    <div style="width: 1px; background: var(--border-color); margin: 0 5px;"></div>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool"
                                        data-tool="resistor" title="Resistore">
                                        <strong>R</strong>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool"
                                        data-tool="potentiometer" title="Potenziometro">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M3 12h3l2-4 4 8 4-8 2 4h3" />
                                            <path d="M12 4v4l-2-2m2 2l2-2" />
                                        </svg>
                                        <strong>Pot</strong>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool"
                                        data-tool="capacitor" title="Condensatore">
                                        <strong>C</strong>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool"
                                        data-tool="inductor" title="Induttore">
                                        <strong>L</strong>
                                    </button>
                                    <div class="circuit-dropdown-container">
                                        <button type="button"
                                            class="btn btn-secondary btn-sm circuit-tool dropdown-trigger"
                                            data-tool="diode" title="Diodi (Clicca per varianti)">
                                            <strong>D ▾</strong>
                                        </button>
                                        <div class="circuit-submenu">
                                            <button type="button" class="submenu-item"
                                                data-tool="diode">Standard</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="diode-zener">Zener</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="diode-schottky">Schottky</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="diode-led">LED</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="diode-photo">Fotodiodo</button>
                                            <button type="button" class="submenu-item" data-tool="diode-tvs">Protezione
                                                (TVS)</button>
                                            <button type="button" class="submenu-item" data-tool="diode-bridge">Ponte
                                                (FWB)</button>
                                            <button type="button" class="submenu-item" data-tool="scr">SCR
                                                (Tiristore)</button>
                                            <button type="button" class="submenu-item" data-tool="diac">DIAC</button>
                                            <button type="button" class="submenu-item" data-tool="triac">TRIAC</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="varactor">Varactor</button>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool" data-tool="led"
                                        title="LED">
                                        <strong>LED</strong>
                                    </button>
                                    <div class="circuit-dropdown-container">
                                        <button type="button"
                                            class="btn btn-secondary btn-sm circuit-tool dropdown-trigger"
                                            data-tool="transistor-npn" title="Transistor (Clicca per varianti)">
                                            <strong>Q ▾</strong>
                                        </button>
                                        <div class="circuit-submenu">
                                            <button type="button" class="submenu-item"
                                                data-tool="transistor-npn">NPN</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="transistor-pnp">PNP</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="mosfet-n">N-MOSFET</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="mosfet-p">P-MOSFET</button>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool"
                                        data-tool="opamp" title="Op-Amp">
                                        <strong>Op</strong>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool"
                                        data-tool="battery" title="Batteria DC">
                                        <strong>V</strong>
                                    </button>
                                    <div class="circuit-dropdown-container">
                                        <button type="button"
                                            class="btn btn-secondary btn-sm circuit-tool dropdown-trigger"
                                            data-tool="voltmeter" title="Strumenti (Clicca per varianti)">
                                            <strong>Inst ▾</strong>
                                        </button>
                                        <div class="circuit-submenu">
                                            <button type="button" class="submenu-item"
                                                data-tool="voltmeter">Voltmetro</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="ammeter">Amperometro</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="multimeter">Multimetro</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="oscilloscope">Oscilloscopio</button>
                                            <button type="button" class="submenu-item" data-tool="funcgen">Gen.
                                                Funzioni</button>
                                            <button type="button" class="submenu-item"
                                                data-tool="powersupply">Alimentatore
                                                DC</button>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool" data-tool="bulb"
                                        title="Lampadina">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M9 18h6" />
                                            <path d="M10 22h4" />
                                            <path d="M12 2v4" />
                                            <path d="M12 18v-4" />
                                            <path d="M12 14v-2" />
                                            <circle cx="12" cy="11" r="5" />
                                            <path d="M8 11l-3 3" />
                                            <path d="M16 11l3 3" />
                                        </svg>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool"
                                        data-tool="switch" title="Interruttore">
                                        <strong>S</strong>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool"
                                        data-tool="ground" title="GND">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M12 5v8" />
                                            <path d="M4 13h16" />
                                            <path d="M7 16h10" />
                                            <path d="M10 19h4" />
                                        </svg>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm circuit-tool" data-tool="text"
                                        title="Testo">
                                        <strong>T</strong>
                                    </button>

                                    <div style="flex:1"></div>

                                    <button type="button" class="btn btn-secondary btn-sm" id="circuit-rotate"
                                        title="Ruota Selezione">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
                                            <path d="M3 3v5h5" />
                                        </svg>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" id="circuit-delete"
                                        style="color: #ef4444;" title="Elimina Selezione">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="3 6 5 6 21 6"></polyline>
                                            <path
                                                d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                                            </path>
                                        </svg>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" id="circuit-clear"
                                        title="Pulisci Tutto">
                                        ALL
                                    </button>
                                </div>

                                <!-- Canvas Area -->
                                <div class="canvas-wrapper"
                                    style="position: relative; overflow: hidden; background: #1e293b; border-radius: 4px; border: 1px solid #334155; height: 400px; display: flex; justify-content: center; align-items: center;">
                                    <canvas id="circuit-canvas" width="800" height="400"
                                        style="background-image: radial-gradient(#334155 1px, transparent 1px); background-size: 20px 20px; cursor: crosshair;"></canvas>
                                </div>
                                <div
                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 8px; display: flex; justify-content: space-between;">
                                    <span>Si consiglia di usare il mouse. Doppio click per ruotare.</span>
                                    <span id="circuit-status">Pronto</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="plc-details-fields" class="hidden">
                        <div class="customization-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="input-group">
                                <label for="plc-cpu">Modello CPU (es. S7-1500, M221)</label>
                                <input type="text" id="plc-cpu" placeholder="CPU 1515-2 PN">
                            </div>
                            <div class="input-group">
                                <label for="plc-env">Ambiente di Sviluppo</label>
                                <select id="plc-env"
                                    style="width: 100%; padding: 0.75rem; background: rgba(30, 41, 59, 0.7); border: 1px solid var(--border-color); color: white; border-radius: 0.5rem; outline: none;">
                                    <option value="Tia Portal">Siemens TIA Portal</option>
                                    <option value="Machine Expert - Basic">Schneider Machine Expert (SoMachine)</option>
                                    <option value="Codesys">Codesys</option>
                                    <option value="Studio 5000">Rockwell Studio 5000</option>
                                    <option value="Altro">Altro</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- EXTRAS: Screenshots & Flowcharts -->
                    <div class="section-header"
                        style="background: rgba(255, 255, 255, 0.05); border-top: 1px solid var(--border-color); padding-top: 1rem; margin-top: 1rem;">
                        <span class="section-title">2. Extra: Screenshot</span>
                    </div>

                    <div class="customization-grid" style="grid-template-columns: 1fr; padding-bottom: 2rem;">


                        <!-- Screenshots Input -->
                        <div class="input-group">
                            <label>Screenshot & Prove di Funzionamento</label>
                            <div class="file-input-wrapper">
                                <input type="file" id="screenshot-upload" accept="image/*" multiple class="hidden">
                                <button type="button" class="btn btn-secondary btn-sm"
                                    onclick="document.getElementById('screenshot-upload').click()">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                        <polyline points="21 15 16 10 5 21"></polyline>
                                    </svg>
                                    Aggiungi Immagini
                                </button>
                            </div>
                            <div id="screenshots-list" class="screenshots-preview-list">
                                <!-- Preview delle immagini caricate con didascalia -->
                            </div>
                        </div>
                    </div>

                </section>

                <section class="flowchart-section hidden"
                    style="display: flex; flex-direction: column; background: var(--card-bg); backdrop-filter: blur(12px); border: 1px solid var(--border-color); border-radius: 1rem; overflow: hidden;">
                    <div class="section-header">
                        <span class="section-title">Flowchart Editor</span>
                        <a href="http://flowchart.js.org/" target="_blank"
                            style="font-size: 0.8rem; color: var(--accent-color);">Guida Sintassi</a>
                    </div>
                    <textarea id="flowchart-main-input" placeholder="st=>start: Inizio
op1=>operation: Operazione 1
cond=>condition: Condizione?
e=>end: Fine

st->op1->cond
cond(yes)->e
cond(no)->op1" spellcheck="false" class="code-editor-area"
                        style="font-family: monospace; padding: 1.5rem; resize: none; flex: 1; outline: none; background: transparent; color: var(--text-primary); border: none; line-height: 1.6;"></textarea>
                </section>

                <section class="editor-section">
                    <div class="section-header" style="justify-content: space-between;">
                        <span class="section-title">Editor Code (Multi-File)</span>
                        <div style="display: flex; gap: 10px;">
                            <input type="file" id="plc-file-upload" accept=".xml,.scl,.awl,.txt" class="hidden">
                            <button id="import-plc-btn" class="btn btn-secondary btn-sm hidden"
                                style="font-size: 0.75rem; border: 1px dashed var(--accent-color);">
                                Importa TIA File
                            </button>
                            <button id="add-file-btn" class="btn btn-secondary btn-sm" style="font-size: 0.75rem;">
                                + Nuovo File
                            </button>
                        </div>
                    </div>

                    <!-- Tab Bar -->
                    <div id="file-tabs-bar" class="file-tabs-bar">
                        <!-- Tabs generated by JS -->
                        <!-- Example: <div class="file-tab active">main.c <span class="close-tab">&times;</span></div> -->
                    </div>

                    <textarea id="code-input" placeholder="// Scrivi il tuo codice C qui..." spellcheck="false"
                        class="code-editor-area"></textarea>
                </section>
            </div>

            <section class="preview-section">
                <div class="section-header">
                    <span class="section-title">Anteprima</span>
                </div>
                <div class="preview-container" id="real-time-preview">
                    <div class="pdf-page-mock">
                        <div class="pdf-custom-header">
                            <div id="pdf-logo-container"></div>
                            <div class="pdf-info-text">
                                <div id="pdf-school-display"></div>
                                <div id="pdf-student-display"></div>
                                <div id="pdf-date-display" class="pdf-date"></div>
                            </div>
                        </div>

                        <div class="pdf-main-title">
                            <h2 id="pdf-title-display">Relazione di Laboratorio</h2>
                        </div>

                        <div id="pdf-exercise-container" class="pdf-exercise-box hidden">
                            <div class="pdf-exercise-label">Consegna:</div>
                            <div id="pdf-exercise-display"></div>
                        </div>

                        <!-- Sezioni Laboratorio nel PDF (Dynamic) -->
                        <div id="pdf-lab-container"></div>

                        <!-- FLOWCHART PDF SECTION (Dynamic) -->
                        <div id="pdf-flowchart-container"></div>

                        <!-- CODE FILES CONTAINER -->
                        <div id="pdf-code-container">
                            <pre><code id="code-output" class="language-c"></code></pre>
                        </div>

                        <!-- SCREENSHOTS PDF SECTION -->
                        <div id="pdf-screenshots-container" class="pdf-lab-section hidden">
                            <div class="pdf-lab-label">Screenshot & Output:</div>
                            <div id="pdf-screenshots-grid"
                                style="display: grid; grid-template-columns: 1fr; gap: 20px;"></div>
                        </div>

                        <!-- CONCLUSIONS CONTAINER (Moved after Screenshots) -->
                        <div id="pdf-conclusions-container"></div>


                    </div>
                </div>
            </section>
        </main>

    </div>



    <!-- Help Modal -->
    <div id="info-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Guida alla Compilazione</h2>
                <button id="close-modal" class="btn-close">&times;</button>
            </div>
            <div id="modal-body" class="modal-body">
                <!-- Content will be injected by JS -->
            </div>
            <div class="modal-footer">
                <button id="close-modal-btn" class="btn btn-primary">Ho capito</button>
            </div>
        </div>
    </div>

    <!-- Prism.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Flowchart.js (requires Raphael) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.17.1/flowchart.min.js"></script>
    <!-- jsPDF & html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="app.js"></script>
</body>

</html>